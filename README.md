# Lotto
딥러닝을 사용한 로또번호에 대한 고찰

1. 제목: LSTM 알고리즘을 활용한 동행복권 번호 예측 프로그램
2. 요약
 2-1) 데이터 수집
 동행복권의 1회부터 1,064회차까지의 당첨 번호 데이터를 수집함.
 (출처:　「동행복권」 https://dhlottery.co.kr/) 
 2-2) 데이터 전처리
 수집한 데이터를 전처리하여 LSTM 알고리즘이 분석할 수 있는 형태로 가공. 
 이 과정에서, 당첨 번호를 One-Hot Encoding 방식으로 변환함.
 데이터를 train: (0, 800), val: (801, 900), test: (901, 1063)로 나눔.
 2-3) LSTM 모델 학습
 전처리 된 데이터를 바탕으로 LSTM 모델을 학습.
 2-4) 모델 검증 
 학습이 완료된 모델이 테스트케이스에서 얼마의 상금을 획득할 수 있는지 평가.
 2-5) 미래 복권번호 예측 및 구매하여 확인
 모든 복권 데이터를 학습하여 미래의 복권번호를 예측하고, 실제 구매해 봄으로써 확인. 
3. 사용 데이터 요약
 3-1) 동행복권의 1회부터 1,064회차까지의 당첨 번호, 등수별 상금 데이터.
 (출처:　「동행복권」 https://dhlottery.co.kr/)
4. 상세 수행 내용
 전제: 지금까지의 로또 번호를 딥러닝에서 학습 시키면 딥러닝이 로또 번호의 원리를 깨달 
 아서 그 원리대로 그다음 회 로또 번호를 예측할 수 있다.
 4-1) 데이터 수집
 동행복권 홈페이지에서 1,064회까지의 당첨 번호, 당첨금액을 엑셀 파일로 수집합니다.
 데이터 목록:
 회차
 첫 번째 당첨 번호
 두 번째 당첨 번호
 세 번째 당첨 번호
 네 번째 당첨 번호
 다섯 번째 당첨 번호
 여섯 번째 당첨 번호
 보너스 번호
 1등 당첨금액
 2등 당첨금액
 3등 당첨금액
 4등 당첨금액
 5등 당첨금액
 
 4-2) 번호를 범주형으로 전환하기
 로또 번호는 각 번호가 수치상의 의미나 숫자들의 위치가 의미가 없으므로 ‘범주형 데 
 이터’이다. 
 로또 번호를 수치상의 의미가 있는 것이 아닌 45개 경우의 수 중 하나인 클래스로 다루 
 기위해 원 핫 인코딩을 한다.
 원 핫 인코딩은 범주형 데이터를 다루는 데 일반적으로 사용되는 기법이다.
 원 핫 인코딩 예시:
 01 : 100000000000000000000000000000000000000000000
 02 : 010000000000000000000000000000000000000000000
 03 : 001000000000000000000000000000000000000000000
 …
 44 : 000000000000000000000000000000000000000000010
 45 : 000000000000000000000000000000000000000000001
 4-3) 모델의 입출력 정의
 이전 회차의 당첨 번호를 넣어서 다음 회차의 당첨 번호를 예측하는 것입니다.
 이전 회차 당첨 번호 > |모델| > 다음 회차 당첨 번호 예측
 1회 당첨 번호를 모델에 입력하면, 모델에서 2회 당첨 번호를 알려준다고 예를 들겠습니 
 다.
 1:[10,23,29,33,37,40]
 2:[9,13,21,25,32,42]
 1:[0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0.
 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0.]
 2:[0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 000000000100000000000010000010001000100100000 
 > |모델| > 000000001000100000001000100000010000000001000
 4-4) 샘플의 구성
 샘플은 지도학습 문제에서 하나의 문제(X)와 정답(Y)의 한 쌍을 의미합니다. 따라서 이 경 
 우 지도학습 모델의 입력이 문제가 되고, 모델의 출력의 정답이 됩니다.
 (1회차 당첨번호, 2회차 당첨번호)
 (2회차 당첨번호, 3회차 당첨번호)
 (3회차 당첨번호, 4회차 당첨번호) …
 numbers
 X[0]: [10, 23, 29, 33, 37, 40]
 Y[0]: [9, 13, 21, 25, 32, 42]
 ohbins
 X[0]: [0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0.
 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 1. 0. 0. 0. 0. 0.]
 Y[0]: [0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.
 1. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 4-5) 데이터 셋 구성
 훈련셋: (1회 입력, 2회 출력)부터 (800회 입력, 801회)까지 700개 샘플
 검증셋: (801회, 802회)부터 (900회, 901회)까지 100개 샘플
 시험셋: (901회, 902회)부터 (1063회, 1064회)까지 163개 샘플
 4-6) 모델 구성
 모델을 딥러닝 라이브러리 중 하나인 텐서플로의 케라스를 이용합니다.
 45개의 벡터로 출력합니다.
 각각의 벡터는 0.0과 1.0 사이의 실숫값으로 나옵니다.
 멀티레이블 문제라 출력층의 활성화함수를 sigmoid로 설정하였습니다.
 4-7) 모델 학습
 100 에포크 학습 시행. 매 에포크 저장된 훈련셋의 손실 값 및 정확도와 검증셋의 손 
 실값 및 정확도에 대해서 기록한 것을 그래프로 표현.
 4-8) 모델 검증
 모델이 10개의 복권번호를 출력하고 훈련셋, 검증셋, 시험셋에서 얼마나 많은 상금을 획 
 득하였는지 검증합니다.
 1. (a)회차 당첨번호를 모델에 입력한 후 모델 출력으로부터 10판의 번호를 생성한 뒤 
 (a+1)회차와 비교하여 등수와 상금 계산
 2. (a+1)회차 당첨번호를 모델에 입력한 후 모델 출력으로부터 10판의 번호를 생성한 뒤 
 (a+2)회차와 비교하여 등수와 상금 계산
 .
 .
 .
 
 
4-8) 미래 복권번호 예측
 1,064개의 훈련셋을 학습시켜 미래의 복권번호를 예측합니다.
 
 receive numbers
 0 : [22, 27, 31, 35, 37, 40]
 1 : [14, 18, 22, 26, 29, 31]
 2 : [9, 14, 26, 31, 34, 40]
 3 : [22, 26, 27, 31, 35, 37]
 4 : [22, 26, 28, 29, 37, 38]
 5 : [13, 14, 18, 26, 31, 37]
 6 : [6, 22, 26, 31, 37, 38]
 7 : [5, 22, 26, 31, 37, 40]
 8 : [9, 22, 26, 31, 35, 40]
 9 : [12, 22, 26, 31, 37, 40]
 4-8) 실제로 복권을 구매하여 확인
결과: 5등 1개
5. 구글 코랩 파일
https://colab.research.google.com/drive/15TUETccTHHr7Oq4g35TrX9XaRMAYBYOV?
usp=sharing

6. 분석 및 고찰
 모델 학습 결과를 분석해보면 모델 학습에서는 일반적인 학습 결과와는 다르게 val loss가 
처음부터 끝까지 지속해서 증가하는 모습을 볼 수 있습니다. 이는 모델이 훈련 데이터에 대해
서는 좋은 성능을 보이지만 새로운 데이터에 대해서는 일반화하지 못한다는 뜻입니다. 이는 
과적합(overfitting)의 징후로 추정됩니다. 과적합은 모델이 훈련 데이터에 너무 맞추어져서 
새로운 데이터에 대한 일반화 성능이 떨어지는 현상입니다. 결국 본 모델은 복권번호를 효과
적으로 예측하지 못함을 알 수 있습니다. 이는 모델 검증 결과에서 더 확실히 드러납니다. train set인 800회까지는 많은 상금을 획득한 것이 보이지만, 그 이후로는 급격히 획득 상금
의 액수가 줄어든 것을 보입니다. 1,064회의 train set을 학습하여 예측한 미래 예측 복권번호를 실제로 사용한 결과도 일반적
인 무작위 선택과 큰 차이가 없음을 알 수 있습니다. 결국 인터넷상에서 광고하는 ‘AI 복권번호 추천’, ‘AI 로또 예상 번호’는 아무런 효력이 없는 
상품이라는 것이 확인되었습니다
